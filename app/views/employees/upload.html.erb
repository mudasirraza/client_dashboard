<div class="container mt-2">
  <h2>Import Employees</h2>
</div>
<div class="container">
  <%= form_with(url: upload_employees_path, local: true) do |form| %>
    <% if @errors.present? %>
      <div class="alert alert-danger">
        <h4>The import was not successful!</h4>
        <ul>
        <% @errors.each do |error| %>
          <li><%= error %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <div class="field">
        <%= form.label :select_your_excel_file, class: "col-sm-2 control-label" %>
        <div class="col-sm-4">
          <%= form.file_field :file, 
            class: "form-control-file",
            required: 'required', 
            accept: valid_excel_import_types %>
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-10">
        <%= form.submit "Upload", class: 'btn btn-primary' %>
      </div>
    </div>
  <% end %>
</div>
<div class="container">
  <%= link_to 'Back', employees_path %> | 
  <%= link_to "Refresh", upload_employees_path, :method => :get %>
</div>
<br />

<% if @report.present? %>
<div class="container table-responsive alert alert-secondary">
  <h4>Import finished!</h4>
  <table class="table table-hover table-sm">
    <thead class="thead-dark">
      <tr>
        <th>Total records imported</th>
        <th>Skipped</th>
      </tr>
    </thead>

    <tbody>
        <tr>
          <td><%= @report[:total] %></td>
          <td><%= @report[:skipped] %></td>
        </tr>
    </tbody>
  </table>
  <% if @report[:skipped_reasons].present? %>
    <div class="form-group">
      <label for="txt1">Skipped Log:</label>
      <textarea class="form-control" id="txt1" rows="5" readonly>
        <% @report[:skipped_reasons].each do |k, v| %>
row # <%= k %> : <%= v %>
        <% end %>
      </textarea>
    </div>
  <% end %>
</div>
<% end %>
